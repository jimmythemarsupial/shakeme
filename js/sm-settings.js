

/***************************************************************************************************
*
*
***************************************************************************************************/
class SMSettings {
	
	
	/***********************************************************************************************
	*
	*
	***********************************************************************************************/
	constructor() {
		this.defaults = {
			obs_ip_address: '127.0.0.1',
			obs_port: 4444
		};
	}
	
	
	/***********************************************************************************************
	*
	*
	***********************************************************************************************/
	get(names, callback) {
		if (window.logger) logger.log('Get setting ' + names);
		var single = false
		if (typeof(names) == 'string')
		{
			names = [ names ];
			single = true;
		}
		var _this = this;
		if (chrome.storage) chrome.storage.local.get(names, function(data) {
			for (var i = 0; i < names.length; i++)
			{
				if (data[names[i]] == undefined)
				{
					data[names[i]] = _this.defaults[names[i]];
				}
			}
			if (single)
			{
				data = data[names[0]];
			}
			callback(data);
		});
	}
	
	
	/***********************************************************************************************
	*
	*
	***********************************************************************************************/
	set(name, value, callback) {
		if (window.logger) logger.log('Setting ' + name + ' to ' + value);
		var setting = { };
		setting[name] = value;
		if (chrome.storage) chrome.storage.local.set(setting, function() {
			if (window.logger) logger.log('Set ' + name + ' to ' + value);
			if (callback)
			{
				callback(name, value);
			}
		});
	}
	
	
	/***********************************************************************************************
	*
	*
	***********************************************************************************************/
	clear() {
		chrome.storage.local.clear();
	}
	
	
}


/***************************************************************************************************
*
*
***************************************************************************************************/
var settings = new SMSettings();

